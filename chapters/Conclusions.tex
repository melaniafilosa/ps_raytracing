\chapter{Conclusions}
In this thesis we investigated new methods based on \textit{phase space ray tracing for illumination optics}. The aim was to understand how light propagates through non imaging optical systems in order to calculate the target photometric variables, e.g. luminance and intensity. 
The core of this work is to use the \textit{phase space} which provided a full description of geometric optics. Phase space consists of all the rays positions and directions. Thus, each ray is described by a unique point in phase space. In this thesis we restrict ourselves to two-dimensional optical systems the phase space of which is a two-dimensional space. 
\ \indent The phase space representation of the optical system shows that for every ray traced inside the system its path, that is the sequence of the optical lines that it encounters, can be considered. All the rays that follow the same path are located inside the same patches in phase space which is therefore divided into closed regions each of them is formed by all rays that follow the same path. The edge-ray principle guaranties that all the rays located at the boundaries of the regions in source phase space are located on the boundaries also in target phase space, \cite{Ries:2}. our idea is therefore to determine the boundaries of those regions to obtain all the information needed to calculate the photometric variables. %For example, the \'{e}tendue can be seen as the area covered by the rays in phase space (area of the regions at the target phase space) which can be calculated from the boundaries either using numerical integration or even analytically for very simple systems. The luminance is the power distribution in phase space. For systems formed by a Lambertian source (constant luminance), the output luminance is equal to zero outside the regions at the target phase space illuminated by the source and it assumes a constant value inside it. Thus the boundaries are sufficient for computing the profile of the target luminance. In case of a non Lambertian source, an interpolation between the rays located at the boundaries along all the possible directions provides the profile of the output luminance. The intensity is given by an integration of the luminance along all the possible positions in phase space. In case of Lambertian source, the intensity is simply the support of the luminance which is given by the sum of the distances between the boundaries rays for every direction. In case of a non Lambertian source, a numerical integration provides the target intensity profile. 
Based on this idea, we developed two methods: the phase space ray tracing and the inverse ray mapping in phase space. The purpose of both is to trace only the rays close to the boundaries reducing to the total number of rays traced compared to the exiting methods used for the intensity calculation as, for example, Monte Carlo and Quasi-Monte Carlo ray tracing.
\\ \\ \indent \textbf{Phase space ray tracing} exploits the phase space of the source and the target of the optical system. In Chapter \ref{chap:PS} we introduced a procedure to construct a triangulation on the source phase space which allows increasingly tracing rays close the boundaries and only few rays inside the regions with positive luminance. 
The boundaries of those regions were approximated using two different approaches: the $\alpha$-shapes method and a technique based on the triangulation refinement. The first one relies on a parameter $\alpha$ which establishes which triangles have to be kept in the PS triangulation and which once have to be removed from it to approximate the boundaries correctly. 
%In general is not easy to determine the desired parameter $\alpha$. In Chapter \ref{chap:boundaries_alpha} we developed a procedure based on \'{e}tendue conservation that provides an estimation of the parameter $\alpha$ that gives a good accuracy of the boundaries computation from which the intensity can be calculated. 
In Chapter \ref{chap:boundaries_alpha} numerical results are provided for two different kinds of TIR-collimators. They showed that phase space ray tracing using $\alpha$-shapes is much faster and more accurate than Monte Carlo ray tracing. We observed that the speed of convergence depends on the smoothness of the shape of the regions in target phase space and, therefore, on the optical system. To eliminate the parameter $\alpha$ from the calculation of the boundaries, we developed a new approach for the boundaries computation based on the triangulation refinement explained in Chapter \ref{chap:triangulation}. This technique is able to determine the boundaries triangles of the triangulation that is those that are crossed by a boundary. Connecting the vertices of the boundaries triangles corresponding to the rays that follow the same path, a good approximation of all the boundaries is obtained. Tracing more rays leads to construct smaller triangles resulting in a better accuracy of the boundaries computation. 
%We provided a stopping criterion for the triangulation refinement employing \'{e}tendue conservation. 
The method was applied to several optical systems with reflected and refractive optical lines. The results show that the boundaries of all the regions with positive luminance in target PS are calculated correctly even for complicated systems such as the parabolic reflector for which multiple reflection of the rays with the mirrors can occur. 
The intensity was computed assuming a Lambertian source. 
% Systems formed by a Lambertian source are particularly relevant in geometric optics because..
The intensity profile obtained using phase space ray tracing based on the triangulation refinement is compared to the two intensities found with Monte Carlo (MC) and Quasi-Monte Carlo (QMC) ray tracing. Significant advantages in terms of the accuracy and the computational time were observed with our method. Phase space ray tracing allows tracing far less rays compared to MC ray tracing resulting in a significant reduction of the computational time. Moreover, the results showed that for some systems, as for example the TIR-collimator, phase space ray tracing outperforms also QMC ray tracing and it has a behavior similar to QMC for more complicated systems as for the parabolic reflector.
In order to further improve the phase space ray tracing we developed a second method that allows trace only the rays located exactly on the boundaries of the regions with positive luminance. 
\\ \\ \indent \textbf{The inverse ray mapping} employs the phase space of all the lines that form the system. For the lines that can receive and emit light two phase spaces are considered: the phase space of the line as a source (which contains the information of the incident rays) and the phase space of the line as a target (which contains the information of the reflected or refracted rays). For the source and the target one phase space was considered (the source and the target phase space, respectively). The idea was to construct an inverse map from the target to the source that connects the coordinates of the rays on the phase space of each optical line that it encounters. \\ \indent 
In Chapter \ref{chap:raymapping1} we presented the analytic method for systems formed by straight line segments. We showed that the boundaries of the regions that form every phase space considered can be calculated \textit{analytically}. Because of this, the inverse ray mapping reconstruction calculates the intensity \textit{exactly}. Compared to QMC ray tracing the method is much more accurate (the exact intensity is found) and also faster. In Chapter \ref{chap:raymapping2} we introduced the numerical inverse ray mapping which is an extension of the analytic method to systems formed by curved lines. In this case the boundaries of all the phase spaces cannot be calculated analytically, therefore a bisection procedure combined with the inverse ray tracing is developed for determining the boundaries of the regions with positive luminance in phase space. As a consequence the \textit{exact} target intensity cannot be provided for systems formed by curved line. Nevertheless, the method remains very accurate and numerical results show that it is able to detect numerical noise. Compared to QMC ray tracing the inverse ray mapping method results more accurate and faster also for complicated systems as the parabolic reflector. \\ \indent 
Finally, in Chapter \ref{chap:fresnel} we investigated systems were also Fresnel reflection was involved. Fresnel systems lead to multiple paths due to the fact that, at every interaction with a Fresnel line, each ray is splitted in two more rays (reflected and the transmitted). The inverse ray mapping is able to detect \textit{all} the possible paths that can occur. Moreover, we shown that only the rays located on the boundaries of the regions in target phase space related to the physical paths are traced from the target to the source. To validate our method we traced forward a set of rays using MC ray tracing and we showed that the boundaries found with the inverse ray mapping encompass all the rays traced. 
The power of energy associated to each ray on the boundary is calculated. 
We explained how to compute the luminance for Fresnel systems where it is not constant. 
\\ \\ \indent In this thesis we showed that phase space is a powerful concept that fully characterize the optical systems. We presented two new methods based on phase space which allow traced far less rays than existing procedures to obtain the desired accuracy. This results in a significant reduction of the computational time. We evaluated the method for several optical systems in two-dimensions.
It might be useful to investigate few more things in two-dimensions. Regarding phase space ray tracing could be interested to analyze systems with a non Lambertian source. Our insight is to calculate the boundaries as explained for a Lambertian source and then compute the profile of the luminance using an interpolation between the rays on the boundaries. The intensity can be obtained by merely integrating the luminance along all the possible positions. Regarding the numerical inverse ray mapping we are interested in provide simulations for calculating the intensity profile also for systems with Fresnel reflection. The results shown in Chapter \ref{chap:fresnel} give the expectation that the inverse ray mapping method is suitable for systems with Fresnel reflection and that it is not only much more precise but also faster than both MC and QMC ray tracing. We believe that the two methods developed in two dimensions are ready to be extended to three dimensional systems. We believe that they can constitutes design tools for optical designers and that the time to design the optical systems would be greatly reduced. The numerical inverse ray mapping could be used also to detect and reduce ghost stray light.